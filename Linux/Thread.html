<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Thread | Today I Learned</title>
    <meta name="generator" content="VuePress 1.5.2">
    
    <meta name="description" content="오늘 공부한건 오늘 적자">
    <link rel="preload" href="/TIL/assets/css/0.styles.6f2ed620.css" as="style"><link rel="preload" href="/TIL/assets/js/app.4477a6e9.js" as="script"><link rel="preload" href="/TIL/assets/js/2.d932b840.js" as="script"><link rel="preload" href="/TIL/assets/js/75.2fecec75.js" as="script"><link rel="prefetch" href="/TIL/assets/js/10.a9775de7.js"><link rel="prefetch" href="/TIL/assets/js/100.4be451e2.js"><link rel="prefetch" href="/TIL/assets/js/101.5c0dd2a9.js"><link rel="prefetch" href="/TIL/assets/js/102.2a821860.js"><link rel="prefetch" href="/TIL/assets/js/103.dbc2eca9.js"><link rel="prefetch" href="/TIL/assets/js/104.7cce1f2c.js"><link rel="prefetch" href="/TIL/assets/js/105.7a53c8c8.js"><link rel="prefetch" href="/TIL/assets/js/106.fa6ce8ad.js"><link rel="prefetch" href="/TIL/assets/js/107.32374aee.js"><link rel="prefetch" href="/TIL/assets/js/108.5941ccd2.js"><link rel="prefetch" href="/TIL/assets/js/109.ae810d02.js"><link rel="prefetch" href="/TIL/assets/js/11.caa86329.js"><link rel="prefetch" href="/TIL/assets/js/110.2451733b.js"><link rel="prefetch" href="/TIL/assets/js/111.5deda254.js"><link rel="prefetch" href="/TIL/assets/js/112.bdfc36e9.js"><link rel="prefetch" href="/TIL/assets/js/113.a86e9b96.js"><link rel="prefetch" href="/TIL/assets/js/114.a6cfb53f.js"><link rel="prefetch" href="/TIL/assets/js/115.59ea2d43.js"><link rel="prefetch" href="/TIL/assets/js/116.f4be3d13.js"><link rel="prefetch" href="/TIL/assets/js/117.e69b7b16.js"><link rel="prefetch" href="/TIL/assets/js/118.aab67b3b.js"><link rel="prefetch" href="/TIL/assets/js/119.51930b3c.js"><link rel="prefetch" href="/TIL/assets/js/12.ed948068.js"><link rel="prefetch" href="/TIL/assets/js/120.174a77d7.js"><link rel="prefetch" href="/TIL/assets/js/121.7ecf23f0.js"><link rel="prefetch" href="/TIL/assets/js/122.65ccc4e6.js"><link rel="prefetch" href="/TIL/assets/js/123.8882b3f0.js"><link rel="prefetch" href="/TIL/assets/js/124.8b985d31.js"><link rel="prefetch" href="/TIL/assets/js/125.99d89518.js"><link rel="prefetch" href="/TIL/assets/js/126.fb8d3e10.js"><link rel="prefetch" href="/TIL/assets/js/127.d2de5cce.js"><link rel="prefetch" href="/TIL/assets/js/128.98a1807c.js"><link rel="prefetch" href="/TIL/assets/js/129.913d1b77.js"><link rel="prefetch" href="/TIL/assets/js/13.57a267ac.js"><link rel="prefetch" href="/TIL/assets/js/130.9da59dcb.js"><link rel="prefetch" href="/TIL/assets/js/131.b1cbf21f.js"><link rel="prefetch" href="/TIL/assets/js/132.c102176e.js"><link rel="prefetch" href="/TIL/assets/js/133.258864b1.js"><link rel="prefetch" href="/TIL/assets/js/134.b389959b.js"><link rel="prefetch" href="/TIL/assets/js/135.13e233c1.js"><link rel="prefetch" href="/TIL/assets/js/136.c50f61ac.js"><link rel="prefetch" href="/TIL/assets/js/137.189d4844.js"><link rel="prefetch" href="/TIL/assets/js/138.7a17d280.js"><link rel="prefetch" href="/TIL/assets/js/139.7c2564f2.js"><link rel="prefetch" href="/TIL/assets/js/14.aae8fb72.js"><link rel="prefetch" href="/TIL/assets/js/140.ff6cd40c.js"><link rel="prefetch" href="/TIL/assets/js/141.27edb8cb.js"><link rel="prefetch" href="/TIL/assets/js/142.5cd707be.js"><link rel="prefetch" href="/TIL/assets/js/143.11d1df51.js"><link rel="prefetch" href="/TIL/assets/js/144.b1815d85.js"><link rel="prefetch" href="/TIL/assets/js/145.2e4db2c0.js"><link rel="prefetch" href="/TIL/assets/js/146.c16ce85b.js"><link rel="prefetch" href="/TIL/assets/js/147.42459dae.js"><link rel="prefetch" href="/TIL/assets/js/148.55b9e54d.js"><link rel="prefetch" href="/TIL/assets/js/149.d97dd854.js"><link rel="prefetch" href="/TIL/assets/js/15.9809e682.js"><link rel="prefetch" href="/TIL/assets/js/150.df2aab0d.js"><link rel="prefetch" href="/TIL/assets/js/151.e8a7afb0.js"><link rel="prefetch" href="/TIL/assets/js/152.6abbe1ff.js"><link rel="prefetch" href="/TIL/assets/js/153.715a6ab8.js"><link rel="prefetch" href="/TIL/assets/js/16.3f07aef8.js"><link rel="prefetch" href="/TIL/assets/js/17.47d1abba.js"><link rel="prefetch" href="/TIL/assets/js/18.eb67986d.js"><link rel="prefetch" href="/TIL/assets/js/19.3e0748c5.js"><link rel="prefetch" href="/TIL/assets/js/20.c2f5738b.js"><link rel="prefetch" href="/TIL/assets/js/21.57f98123.js"><link rel="prefetch" href="/TIL/assets/js/22.75067234.js"><link rel="prefetch" href="/TIL/assets/js/23.89e338a7.js"><link rel="prefetch" href="/TIL/assets/js/24.5a7676a5.js"><link rel="prefetch" href="/TIL/assets/js/25.43aaa948.js"><link rel="prefetch" href="/TIL/assets/js/26.c4b1517e.js"><link rel="prefetch" href="/TIL/assets/js/27.151a1da9.js"><link rel="prefetch" href="/TIL/assets/js/28.d38f4fe8.js"><link rel="prefetch" href="/TIL/assets/js/29.994c03ff.js"><link rel="prefetch" href="/TIL/assets/js/3.9cc0f49f.js"><link rel="prefetch" href="/TIL/assets/js/30.5ad94d6c.js"><link rel="prefetch" href="/TIL/assets/js/31.cbc394dc.js"><link rel="prefetch" href="/TIL/assets/js/32.0d06c711.js"><link rel="prefetch" href="/TIL/assets/js/33.8bd5f1b6.js"><link rel="prefetch" href="/TIL/assets/js/34.aeecabcb.js"><link rel="prefetch" href="/TIL/assets/js/35.71234b7c.js"><link rel="prefetch" href="/TIL/assets/js/36.36538ee3.js"><link rel="prefetch" href="/TIL/assets/js/37.a09f5283.js"><link rel="prefetch" href="/TIL/assets/js/38.1c86bb82.js"><link rel="prefetch" href="/TIL/assets/js/39.2ea8224c.js"><link rel="prefetch" href="/TIL/assets/js/4.dae613d4.js"><link rel="prefetch" href="/TIL/assets/js/40.0cbf0ee9.js"><link rel="prefetch" href="/TIL/assets/js/41.a210b8b2.js"><link rel="prefetch" href="/TIL/assets/js/42.98625ffb.js"><link rel="prefetch" href="/TIL/assets/js/43.ea46bd9e.js"><link rel="prefetch" href="/TIL/assets/js/44.56d2bd9a.js"><link rel="prefetch" href="/TIL/assets/js/45.06f448c5.js"><link rel="prefetch" href="/TIL/assets/js/46.b4171891.js"><link rel="prefetch" href="/TIL/assets/js/47.9aee6c3c.js"><link rel="prefetch" href="/TIL/assets/js/48.6c15cbd0.js"><link rel="prefetch" href="/TIL/assets/js/49.6513d2e7.js"><link rel="prefetch" href="/TIL/assets/js/5.2261f04e.js"><link rel="prefetch" href="/TIL/assets/js/50.785983eb.js"><link rel="prefetch" href="/TIL/assets/js/51.ac9e1ae4.js"><link rel="prefetch" href="/TIL/assets/js/52.9fe9e331.js"><link rel="prefetch" href="/TIL/assets/js/53.079dea73.js"><link rel="prefetch" href="/TIL/assets/js/54.7aeaa7b8.js"><link rel="prefetch" href="/TIL/assets/js/55.4831f250.js"><link rel="prefetch" href="/TIL/assets/js/56.d652602c.js"><link rel="prefetch" href="/TIL/assets/js/57.ac9200be.js"><link rel="prefetch" href="/TIL/assets/js/58.24493e95.js"><link rel="prefetch" href="/TIL/assets/js/59.2ed6c9d5.js"><link rel="prefetch" href="/TIL/assets/js/6.7eed4372.js"><link rel="prefetch" href="/TIL/assets/js/60.fe757b4f.js"><link rel="prefetch" href="/TIL/assets/js/61.8174d3b3.js"><link rel="prefetch" href="/TIL/assets/js/62.1d799694.js"><link rel="prefetch" href="/TIL/assets/js/63.1449ac99.js"><link rel="prefetch" href="/TIL/assets/js/64.f27d5bd1.js"><link rel="prefetch" href="/TIL/assets/js/65.e196ce0e.js"><link rel="prefetch" href="/TIL/assets/js/66.c6f58a7d.js"><link rel="prefetch" href="/TIL/assets/js/67.0f52aafa.js"><link rel="prefetch" href="/TIL/assets/js/68.5dea3fea.js"><link rel="prefetch" href="/TIL/assets/js/69.447de755.js"><link rel="prefetch" href="/TIL/assets/js/7.c1fb9781.js"><link rel="prefetch" href="/TIL/assets/js/70.07e2c378.js"><link rel="prefetch" href="/TIL/assets/js/71.07dc90b4.js"><link rel="prefetch" href="/TIL/assets/js/72.171eda68.js"><link rel="prefetch" href="/TIL/assets/js/73.f12a058a.js"><link rel="prefetch" href="/TIL/assets/js/74.8bd329b4.js"><link rel="prefetch" href="/TIL/assets/js/76.0c9bbc7c.js"><link rel="prefetch" href="/TIL/assets/js/77.d25dcc36.js"><link rel="prefetch" href="/TIL/assets/js/78.6a0ac72c.js"><link rel="prefetch" href="/TIL/assets/js/79.0b5d0c5a.js"><link rel="prefetch" href="/TIL/assets/js/8.77c0d17b.js"><link rel="prefetch" href="/TIL/assets/js/80.60e61d9c.js"><link rel="prefetch" href="/TIL/assets/js/81.a99ad7a3.js"><link rel="prefetch" href="/TIL/assets/js/82.aacab428.js"><link rel="prefetch" href="/TIL/assets/js/83.b8b68826.js"><link rel="prefetch" href="/TIL/assets/js/84.691d8715.js"><link rel="prefetch" href="/TIL/assets/js/85.d5a15339.js"><link rel="prefetch" href="/TIL/assets/js/86.f9e6f18a.js"><link rel="prefetch" href="/TIL/assets/js/87.be34b97e.js"><link rel="prefetch" href="/TIL/assets/js/88.6ea137d8.js"><link rel="prefetch" href="/TIL/assets/js/89.92792946.js"><link rel="prefetch" href="/TIL/assets/js/9.8e880e95.js"><link rel="prefetch" href="/TIL/assets/js/90.b2f85a61.js"><link rel="prefetch" href="/TIL/assets/js/91.b0a11574.js"><link rel="prefetch" href="/TIL/assets/js/92.a89de948.js"><link rel="prefetch" href="/TIL/assets/js/93.38baaa06.js"><link rel="prefetch" href="/TIL/assets/js/94.1104c950.js"><link rel="prefetch" href="/TIL/assets/js/95.97e30f60.js"><link rel="prefetch" href="/TIL/assets/js/96.3b91bcbe.js"><link rel="prefetch" href="/TIL/assets/js/97.c90c3eaf.js"><link rel="prefetch" href="/TIL/assets/js/98.71f9b255.js"><link rel="prefetch" href="/TIL/assets/js/99.4be93aa8.js">
    <link rel="stylesheet" href="/TIL/assets/css/0.styles.6f2ed620.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/TIL/" class="home-link router-link-active"><!----> <span class="site-name">Today I Learned</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://github.com/lee20h/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://github.com/lee20h/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Book</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Algorithm</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JavaScript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Node.js</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>DataBase</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Docker</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Travis CI</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Vuepress</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Operating_System</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Linux</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/TIL/Linux/디렉토리와 파일.html" class="sidebar-link">디렉토리와 파일</a></li><li><a href="/TIL/Linux/관리 권한 및 접근 권한.html" class="sidebar-link">관리 권한 및 접근 권한</a></li><li><a href="/TIL/Linux/Process and Redirection.html" class="sidebar-link">Process and Redirection</a></li><li><a href="/TIL/Linux/유틸리티.html" class="sidebar-link">유틸리티</a></li><li><a href="/TIL/Linux/C Programming on Linux.html" class="sidebar-link">C Programming on Linux</a></li><li><a href="/TIL/Linux/system call.html" class="sidebar-link">System Call</a></li><li><a href="/TIL/Linux/File.html" class="sidebar-link">File: Low-level I/O</a></li><li><a href="/TIL/Linux/File2.html" class="sidebar-link">File: High-level I/O</a></li><li><a href="/TIL/Linux/Dynamic Memory Allocation.html" class="sidebar-link">Dynamic Memory Allocation</a></li><li><a href="/TIL/Linux/Process Management.html" class="sidebar-link">Process Management</a></li><li><a href="/TIL/Linux/IPC.html" class="sidebar-link">IPC: Signal and Shared Memory</a></li><li><a href="/TIL/Linux/Thread.html" aria-current="page" class="active sidebar-link">Thread</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/TIL/Linux/Thread.html#parallel-programming" class="sidebar-link">Parallel Programming</a></li><li class="sidebar-sub-header"><a href="/TIL/Linux/Thread.html#thread-2" class="sidebar-link">Thread</a></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Software_Engineering</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Distribute_Computing</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Open_Source_Software</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Program_Language</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Data_Communication</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Computer_Network</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="thread"><a href="#thread" class="header-anchor">#</a> Thread</h1> <h2 id="parallel-programming"><a href="#parallel-programming" class="header-anchor">#</a> Parallel Programming</h2> <h3 id="병렬-프로그래밍"><a href="#병렬-프로그래밍" class="header-anchor">#</a> 병렬 프로그래밍</h3> <ul><li>공동의 목적을 달성하기 위해, 다수의 실행 주체가 동시에 작업을 수행하는 방식
<ul><li>실행 주체: Process or Thread</li> <li>사실 컴퓨터 시스템에서 프로그램을 실행하는 주체는 CPU (or Core)!!</li> <li>프로세스나 쓰레드는 여러 프로그램이 CPU를 공유해서 사용하기 위한 추상적 단위</li></ul></li> <li>병렬 프로그래밍의 필요성
<ul><li>최근 컴퓨터 시스템은 대부분 다수의 CPU 를 탑재하고 있으며,</li> <li>여러 CPU를 최대한 활용하여 성능을 높이기 위해서는 병렬 프로그래밍이 필수</li></ul></li></ul> <h3 id="소켓-프로그래밍에서는"><a href="#소켓-프로그래밍에서는" class="header-anchor">#</a> 소켓 프로그래밍에서는?</h3> <ul><li>일반적으로 서버는 여러 클라이언트에 대해 동시에 서비스를 제공함
<ul><li>예) 포털에 여러 사람이 동시에 접근하여 각자 서로 다른 서비스를 이용함</li></ul></li> <li>반복 서버
<ul><li>하나의 프로세스가 동작하며 모든 클라이언트의 요청을 순서대로 처리</li> <li>클라이언트는 연결 수립을 위해 이전 클라이언트의 요청이 모두 처리될 때까지 대기하여야 함</li></ul></li> <li>동시 동작 서버 (Parallel or Concurrently running or Multi-user Server)
<ul><li>여러 요청을 동시에 처리해 서비스할 수 있는 서버</li> <li>서버를 병렬로 동작하도록 구성</li> <li>일반적인 서버 역할 분담
<ul><li>Door-keeper process: 문지기 역할. 접속을 대기하다, 요청이 오면 연결을 수립함. 그리고 수립된 각각의 연결에 대해 서비스 프로세스를 할당함. 이를 반복함.</li> <li>Service thread: 각 연결에 대해 1:1로 실제 서비스를 제공하는 쓰레드</li></ul></li></ul></li></ul> <h3 id="반복-서버의-예"><a href="#반복-서버의-예" class="header-anchor">#</a> 반복 서버의 예</h3> <ul><li>지난 소켓에서의 서버-클라이언트 예제 동작 방식
<ul><li>Server: listen()→ accept() → send() → recv() → close()</li> <li>Client: connect() → recv() → send() → close()</li></ul></li> <li>서버 프로세스 수정: 반복 처리 서버
<ul><li>하나의 클라이언트 처리가 종료된 후, 다시 accept()로 돌아와서 대기</li> <li>위 동작을 3번 반복하여, 3개의 클라이언트 요청을 처리하게 함</li></ul></li> <li>만약 클라이언트가 send()를 하지 않는다면?
<ul><li>서버 프로세스는 recv() 에서 무한 대기하며, 해당 클라이언트로부터 패킷이 전송되길 기다릴 것</li></ul></li> <li>그때 만약 다른 클라이언트가 동시에 접속을 요청한다면?
<ul><li>서버가 accept()를 대기하고 있기 않기 때문에, 접속 처리를 할 수 없음</li></ul></li></ul> <h3 id="process-based-parallel-socket-programming"><a href="#process-based-parallel-socket-programming" class="header-anchor">#</a> Process-based Parallel Socket Programming</h3> <ul><li>프로세스 기반 동시 동작 서버
<ul><li>Door-keeper process
<ul><li>기존 서버 코드와 같이 서버 소켓을 열고 bind(), listen() 수행</li> <li>새로운 연결이 수립되면, child process를 만들어, 아래 service 동작을 수행하게 함</li> <li>서버는 fork() 이후, 즉각 다시 accept()에서 대기. 이를 3회 반복함</li> <li>종료 전, 생성된 child 개수만큼 wait()를 수행하여 모든 종료 상태값을 출력 후, 종료</li></ul></li></ul></li> <li>Service process
<ul><li>기존과 같이 send(), recv() 수행하고, 소켓을 닫고, 종료</li></ul></li></ul> <h2 id="thread-2"><a href="#thread-2" class="header-anchor">#</a> Thread</h2> <ul><li><p>두 가지 종류의 실행 주체(execution unit or entity)</p> <ul><li>Process: 독립적인 메모리 공간을 가진 수행 주체
<ul><li>각각 독립적인 메모리 공간을 생성해주고, 관리해주어야 하기 때문에</li> <li>생성/제거에 시간이 오래 걸리고, 시스템 자원을 많이 사용함</li></ul></li> <li>Thread: 프로세스의 단점을 보완하기 위해 새로이 정의된 실행 주체</li></ul></li> <li><p>Thread: <strong>The execution unit in a process</strong></p> <ul><li>Thread = CPU Register set + Independent Stack
<ul><li>하나의 수행 흐름이 다른 수행 흐름과 분리되기 위해 필수적인 요소들만 모아 Thread로 정의</li></ul></li> <li>하나의 프로세스 내에 여러 쓰레드가 함께 동작할 수 있음
<ul><li>쓰레드들은 프로세스의 자원을 공유해서 사용: code, data, heap 영역, File descriptor 등</li></ul></li> <li>장점
<ul><li>프로세스보다 가볍다 (a.k.a. LWP: light-weight process)
<ul><li>여러 쓰레드가 동시에 동작할 때, 여러 프로세스의 경우보다 효율적임 (성능 높음)</li></ul></li> <li>IPC 가 불필요함: 하나의 프로세스 내에서 메모리 공간을 공유하기 때문</li></ul></li> <li>단점: 데이터 공유에 따른 동기화 문제, 오류 전파 (error propagation) 등</li></ul></li> <li><p>Single-threaded Process vs. Multi-threaded Process</p> <ul><li>STP: 전통적인 프로세스의 구조와 동일함
<ul><li>내부에서 명시적으로 쓰레드 관련 서비스를 사용하지 않더라도,</li> <li>코드가 수행되는 하나의 흐름을 쓰레드라는 개념으로 구체화하였음</li> <li>프로세스 생성이 완료되면, 기본 쓰레드가 코드를 순차적으로 수행하기 시작함</li></ul></li> <li>MTP: 쓰레드 개념이 등장하면서 가능해진 구조
<ul><li>여러 쓰레드가 하나의 프로세스 내에서 프로세스의 자원을 공유하며 동시에 수행됨</li></ul></li> <li><strong>“프로세스” 는 더 이상 실행 주체 라기보다, 실행 주체인 쓰레드를 담는 그릇과 같은 역할</strong></li></ul></li></ul> <h3 id="pthread-서비스"><a href="#pthread-서비스" class="header-anchor">#</a> Pthread 서비스</h3> <ul><li>Pthread (POSIX Thread)
<ul><li>POSIX 는 운영체제 API 표준으로, 여러 OS에서 지원하고 있음</li> <li>pthread 라이브러리: POSIX 에서 쓰레드를 관리하기 위한 여러가지 API를 구현한 것
<ul><li>쓰레드 관련 시스템 콜들을 대신 호출하고, 관련 자료 구조를 관리함</li></ul></li> <li>가장 일반적으로 널리 이용되는 쓰레드 라이브러리</li> <li>생성, 종료, 완료 대기, 동기화 관리 (lock) 등의 기능을 제공</li> <li>gcc 컴파일 시, <code>-l pthread</code> 옵션을 사용해 명시적으로 라이브러리 지정을 해주어야 함</li></ul></li></ul> <table><thead><tr><th></th> <th>프로세스</th> <th>쓰레드</th></tr></thead> <tbody><tr><td>생성</td> <td><code>fork()</code></td> <td><code>pthread_create()</code></td></tr> <tr><td>완료 대기</td> <td><code>wait()</code></td> <td><code>pthread_join()</code></td></tr> <tr><td>수행 코드 변경</td> <td><code>exec()</code></td> <td>-</td></tr></tbody></table> <h3 id="쓰레드-생성-pthread-create"><a href="#쓰레드-생성-pthread-create" class="header-anchor">#</a> 쓰레드 생성: pthread_create()</h3> <ul><li>thread: 생성된 쓰레드를 가리키는 구조체. 쓰레드를 가리키기 위한 ID로 사용
<ul><li>TID: Thread ID. 숫자가 아니라 구조체로 표현됨</li> <li>pthread_self()를 통해 확인 가능. pthread_equal()을 통해 비교 가능</li></ul></li> <li>attr: struct pthread_attr_t 로 정의된 쓰레드의 속성들. NULL 인 경우, 기본 속성</li> <li>start_routine: 쓰레드로 수행할 코드의 함수 포인터
<ul><li>void * start_thread (void *arg);</li></ul></li> <li>arg: start_routine 에 전달할 인자</li> <li>Return value
<ul><li>On success: 0 , On error: error number (not zero)</li></ul></li></ul> <h3 id="쓰레드의-종료"><a href="#쓰레드의-종료" class="header-anchor">#</a> 쓰레드의 종료</h3> <ul><li>쓰레드를 종료하는 네 가지 방법
<ul><li>쓰레드 생성 시 지정된 start_routine 에서 return 하는 경우</li> <li>pthread_exit() : 자기 자신을 종료
<ul><li>상태 종료값을 retval 로 전달. retval 은 동적으로 할당하여 사용</li></ul></li> <li>pthread_cancel() : 인자로 지정된 쓰레드를 종료</li> <li>전체 프로세스가 종료되는 경우
<ul><li>main() 함수의 return</li> <li>(어느 thread 에서든) exit() 호출</li> <li>exec() 시리즈로 새로운 코드가 로드된 경우</li></ul></li></ul></li></ul> <h3 id="쓰레드-종료-대기-pthread-join"><a href="#쓰레드-종료-대기-pthread-join" class="header-anchor">#</a> 쓰레드 종료 대기: pthread_join()</h3> <ul><li>thread 의 종료를 대기하고, retval 에 종료 상태값을 전달함
<ul><li>프로세스에서의 wait() 와 유사한 역할</li></ul></li> <li>Return value
<ul><li>On success: 0 , On error: error number (not zero)</li></ul></li> <li>pthread_detach
<ul><li>만약 쓰레드를 join 하지 않기로 결정했다면,</li> <li>detach 를 수행하여 쓰레드 종료 시, 즉각 쓰레드를 destroy 하도록 함</li> <li>예) 프로세스의 경우, wait()를 수행하지 않으면 좀비 프로세스가 됨
<ul><li>쓰레드는 detach 를 시킨 경우, 다른 쓰레드가 join 을 수행하지 않아도 무방함</li></ul></li></ul></li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/TIL/Linux/IPC.html" class="prev">
        IPC: Signal and Shared Memory
      </a></span> <span class="next"><a href="/TIL/SE/시스템 공학과 소프트웨어 공학.html">
        시스템 공학과 소프트웨어 공학
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/TIL/assets/js/app.4477a6e9.js" defer></script><script src="/TIL/assets/js/2.d932b840.js" defer></script><script src="/TIL/assets/js/75.2fecec75.js" defer></script>
  </body>
</html>
